language: python
sudo: false
python:
  - 2.7
  - 3.4
addons:
  apt:
    packages:
      - libgmp-dev
      - libatlas-dev
      - libatlas-base-dev
      - liblapack-dev
      - gfortran
matrix:
  include:
    - python: "pypy3"
      env:
        - PYTEST_EXTRA_ARGS="--ignore sympy/plotting/plot.py --ignore sympy/plotting/plot_implicit.py --ignore sympy/matrices/dense.py --ignore sympy/tensor/tensor.py --ignore sympy/utilities/lambdify.py --ignore examples/advanced/autowrap_ufuncify.py"
before_install:
  - if [[ "${TRAVIS_PYTHON_VERSION}" != "pypy3" ]]; then
      pip uninstall -y numpy;
      travis_wait 30 pip install numpy==1.7.1 scipy==0.12.0 Theano==0.6;
      travis_wait 30 pip install matplotlib==1.3.1;
    fi
  - pip install pytest==2.7.0 pep8==1.6.2
  - if [[ "${TRAVIS_PYTHON_VERSION}" == "2.7" ]]; then
      pip install pytest-cov coveralls --use-mirrors;
    fi
install:
  - python setup.py install
before_script:
  - sh -e /etc/init.d/xvfb start
  - export DISPLAY=:99.0
script:
  - if [[ "${TRAVIS_PYTHON_VERSION}" == "2.7" ]]; then
      PYTEST_EXTRA_ARGS="--cov sympy" python setup.py test;
    else
      python setup.py test;
    fi
  - pep8
after_success:
  - if [[ "${TRAVIS_PYTHON_VERSION}" == "2.7" ]]; then
      coveralls;
    fi
notifications:
  email: false

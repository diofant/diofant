language: python
sudo: false
python:
  - 2.7
  - 3.4
env:
  - EXTRA="[exports,plot]" PYTEST_EXTRA_ARGS=""
addons:
  apt:
    packages:
      - libgmp-dev
      - libatlas-dev
      - libatlas-base-dev
      - liblapack-dev
      - gfortran
matrix:
  include:
    - python: 2.7
      env:
        - EXTRA="[exports,plot,gmpy]"
        - PYTEST_EXTRA_ARGS='--cov=sympy -m="not slow"'
before_install:
  - pip install --upgrade pip setuptools
  - pip uninstall -y pytest py
install:
  - python setup.py install
  - if [[ "${TRAVIS_PYTHON_VERSION}" == "2.7" ]]; then
      pip install pytest-cov coveralls --use-mirrors;
    fi
install:
  - if [[ "${TEST_EXTRA}" == "true" ]]; then
      pip install .[extra,plot,gmpy];
    else
      pip install .;
    fi
before_script:
  - sh -e /etc/init.d/xvfb start
  - export DISPLAY=:99.0
script:
  - python setup.py test
after_success:
  - coveralls
notifications:
  email: false
